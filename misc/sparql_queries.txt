# GET ALL SCANNING ANTIVIRUSES
===============================
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX mowl: <http://www.semanticweb.org/acitea/ontologies/2017/0/malware-ontology#>
SELECT DISTINCT ?object
	WHERE 
	{ 
	    ?subject ?p ?object .
	    ?object rdfs:subClassOf mowl:antivirusresult
	} 


# GET ALL KERNEL32 IMPORTS FOR A SUBJECT
===============================
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX mowl: <http://www.semanticweb.org/acitea/ontologies/2017/0/malware-ontology#>
SELECT DISTINCT ?object
	WHERE 
	{ 
		?subject ?p ?object .
	    ?object a mowl:_kernel32.dll
	} 




# GET ALL BASE PROPERTIES
===============================
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX mowl: <http://www.semanticweb.org/acitea/ontologies/2017/0/malware-ontology#>
SELECT DISTINCT ?target_subtype
WHERE {
     mowl:4ef20963e9b3871c071638bdfec5f9d2   ?p     ?target    .
     
     {
     					?target     rdf:type   owl:Thing 
     }
     UNION
     {
     					?target     rdf:type   ?target_subtype .
                        ?target_subtype       rdfs:subClassOf     owl:Thing         
     }
     UNION
     {
     					?target     rdf:type   ?target_type .
                        ?target_type       rdfs:subClassOf        ?target_subtype .
                        ?target_subtype      rdfs:subClassOf         owl:Thing
     }
     UNION
     { 
                         ?target     rdf:type   ?target_type .
                         ?target_type       rdfs:subClassOf        ?target_subsubtype .
                         ?target_subsubtype      rdfs:subClassOf         ?target_subtype .
                         ?target_subtype     rdfs:subClassOf      owl:Thing
     }
}


COUNT SIMILAR PROPERTIES
==============================================================
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX mowl: <http://www.semanticweb.org/acitea/ontologies/2017/0/malware-ontology#>
SELECT  (COUNT (DISTINCT   ?entity) AS ?count)
WHERE {
     mowl:8b2532df8eeb4706677d7f70a679911f     ?prop    ?entity . 
     mowl:8e63d90b22382d480715002108db8877   ?prop    ?entity
}



GET ALL SIMILAR IMPORTS FROM 2 MD5s
===============================================================
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX mowl: <http://www.semanticweb.org/acitea/ontologies/2017/0/malware-ontology#>
SELECT  DISTINCT ?entity
WHERE {
     mowl:8b2532df8eeb4706677d7f70a679911f     ?prop    ?entity . 
     mowl:8e63d90b22382d480715002108db8877   ?prop    ?entity .
     ?entity rdf:type mowl:_advapi32.dll .
     FILTER( ?entity  != owl:NamedIndividual) 
}



GET NR OF SIMILAR PROPERTIES OF A SUBPROPERTY
================================================================
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX mowl: <http://www.semanticweb.org/acitea/ontologies/2017/0/malware-ontology#>
SELECT  DISTINCT ?entity
WHERE {
    mowl:8b2532df8eeb4706677d7f70a679911f     ?prop    ?entity . 
    mowl:8e63d90b22382d480715002108db8877     ?prop    ?entity .

    {
            ?entity             rdf:type   mowl:pe_imports 
    }
    UNION
    {
            ?entity             rdf:type            ?entity_subtype .
            ?entity_subtype     rdfs:subClassOf     mowl:pe_imports         
    }
    UNION
    {
            ?entity             rdf:type            ?entity_type .
            ?entity_type        rdfs:subClassOf     ?entity_subtype .
            ?entity_subtype     rdfs:subClassOf     mowl:pe_imports
    }
    UNION
    { 
            ?entity                 rdf:type            ?entity_type .
            ?entity_type            rdfs:subClassOf     ?entity_subtype .
            ?entity_subtype         rdfs:subClassOf     ?entity_subsubtype .
            ?entity_subsubtype      rdfs:subClassOf     mowl:pe_imports
    } .
    FILTER(?entity != owl:NamedIndividual)
}







DOING SOMETHING
==============================================================================
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX mowl: <http://www.semanticweb.org/acitea/ontologies/2017/0/malware-ontology#>
SELECT  (COUNT (DISTINCT ?entity) AS ?count_general)  (COUNT (DISTINCT ?entity1) AS ?count_hash1)  (COUNT (DISTINCT ?entity2) AS ?count_hash2)
WHERE {
    mowl:92756a4cba986f4694f7bcddacff9a2a     ?prop    ?entity . 
    mowl:a449c20441b64398e8fad3121daf2757     ?prop    ?entity .

    {
            ?entity             rdf:type   mowl:pe_imports 
    }
    UNION
    {
            ?entity             rdf:type            ?entity_subtype .
            ?entity_subtype     rdfs:subClassOf     mowl:pe_imports         
    }
    UNION
    {
            ?entity             rdf:type            ?entity_type .
            ?entity_type        rdfs:subClassOf     ?entity_subtype .
            ?entity_subtype     rdfs:subClassOf     mowl:pe_imports
    }
    UNION
    { 
            ?entity                 rdf:type            ?entity_type .
            ?entity_type            rdfs:subClassOf     ?entity_subtype .
            ?entity_subtype         rdfs:subClassOf     ?entity_subsubtype .
            ?entity_subsubtype      rdfs:subClassOf     mowl:pe_imports
    } .


    mowl:92756a4cba986f4694f7bcddacff9a2a   ?prop1    ?entity1 .
    {
            ?entity1             rdf:type   mowl:pe_imports 
    }
    UNION
    {
            ?entity1             rdf:type            ?entity1_subtype .
            ?entity1_subtype     rdfs:subClassOf     mowl:pe_imports         
    }
    UNION
    {
            ?entity1             rdf:type            ?entity1_type .
            ?entity1_type        rdfs:subClassOf     ?entity1_subtype .
            ?entity1_subtype     rdfs:subClassOf     mowl:pe_imports
    }
    UNION
    { 
            ?entity1                 rdf:type            ?entity1_type .
            ?entity1_type            rdfs:subClassOf     ?entity1_subtype .
            ?entity1_subtype         rdfs:subClassOf     ?entity1_subsubtype .
            ?entity1_subsubtype      rdfs:subClassOf     mowl:pe_imports
    } .


    mowl:a449c20441b64398e8fad3121daf2757   ?prop2    ?entity2 .
    {
            ?entity2             rdf:type   mowl:pe_imports 
    }
    UNION
    {
            ?entity2             rdf:type            ?entity2_subtype .
            ?entity2_subtype     rdfs:subClassOf     mowl:pe_imports         
    }
    UNION
    {
            ?entity2             rdf:type            ?entity2_type .
            ?entity2_type        rdfs:subClassOf     ?entity2_subtype .
            ?entity2_subtype     rdfs:subClassOf     mowl:pe_imports
    }
    UNION
    { 
            ?entity2                 rdf:type            ?entity2_type .
            ?entity2_type            rdfs:subClassOf     ?entity2_subtype .
            ?entity2_subtype         rdfs:subClassOf     ?entity2_subsubtype .
            ?entity2_subsubtype      rdfs:subClassOf     mowl:pe_imports
    } .

    FILTER(?entity != owl:NamedIndividual)
}






SEARCH SIMILARITIES COUNT BETWEEN MULTIPLE MD5s
====================================================================
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX mowl: <http://www.semanticweb.org/acitea/ontologies/2017/0/malware-ontology#>
SELECT ?md5_2 (COUNT (DISTINCT ?entity) AS ?count_general)  (COUNT (DISTINCT ?entity1) AS ?count_hash1)  (COUNT (DISTINCT ?entity2) AS ?count_hash2)
WHERE {
    mowl:a449c20441b64398e8fad3121daf2757     ?prop    ?entity . 
    ?md5_2     ?prop    ?entity .
    ?md5_2     rdf:type     mowl:File  .
    FILTER(?entity != owl:NamedIndividual) .
    FILTER(?md5_2  != mowl:a449c20441b64398e8fad3121daf2757) .
    
    {
            ?entity             rdf:type   mowl:pe_imports 
    }
    UNION
    {
            ?entity             rdf:type            ?entity_subtype .
            ?entity_subtype     rdfs:subClassOf     mowl:pe_imports         
    }
    UNION
    {
            ?entity             rdf:type            ?entity_type .
            ?entity_type        rdfs:subClassOf     ?entity_subtype .
            ?entity_subtype     rdfs:subClassOf     mowl:pe_imports
    }
    UNION
    { 
            ?entity                 rdf:type            ?entity_type .
            ?entity_type            rdfs:subClassOf     ?entity_subtype .
            ?entity_subtype         rdfs:subClassOf     ?entity_subsubtype .
            ?entity_subsubtype      rdfs:subClassOf     mowl:pe_imports
    } .


    mowl:a449c20441b64398e8fad3121daf2757   ?prop1    ?entity1 .
    {
            ?entity1             rdf:type   mowl:pe_imports 
    }
    UNION
    {
            ?entity1             rdf:type            ?entity1_subtype .
            ?entity1_subtype     rdfs:subClassOf     mowl:pe_imports         
    }
    UNION
    {
            ?entity1             rdf:type            ?entity1_type .
            ?entity1_type        rdfs:subClassOf     ?entity1_subtype .
            ?entity1_subtype     rdfs:subClassOf     mowl:pe_imports
    }
    UNION
    { 
            ?entity1                 rdf:type            ?entity1_type .
            ?entity1_type            rdfs:subClassOf     ?entity1_subtype .
            ?entity1_subtype         rdfs:subClassOf     ?entity1_subsubtype .
            ?entity1_subsubtype      rdfs:subClassOf     mowl:pe_imports
    } .


    ?md5_2   ?prop2    ?entity2 .
    {
            ?entity2             rdf:type   mowl:pe_imports 
    }
    UNION
    {
            ?entity2             rdf:type            ?entity2_subtype .
            ?entity2_subtype     rdfs:subClassOf     mowl:pe_imports         
    }
    UNION
    {
            ?entity2             rdf:type            ?entity2_type .
            ?entity2_type        rdfs:subClassOf     ?entity2_subtype .
            ?entity2_subtype     rdfs:subClassOf     mowl:pe_imports
    }
    UNION
    { 
            ?entity2                 rdf:type            ?entity2_type .
            ?entity2_type            rdfs:subClassOf     ?entity2_subtype .
            ?entity2_subtype         rdfs:subClassOf     ?entity2_subsubtype .
            ?entity2_subsubtype      rdfs:subClassOf     mowl:pe_imports
    } 
}
GROUP BY ?md5_2