<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Malware OWL</title>
	<link rel="stylesheet" href="scholary.css" />
</head>
<body schema="http://schema.org/" xsd="http://www.w3.org/2001/XMLSchema sa="https://ns.science.ai/" >
	<article typeof="schema:ScholarlyArticle" resource="#">
		<h1>Malware OWL</h1>
		<section>
			<ol>
			  <!-- The first author, Robin Berjon -->
			  <li property="schema:author" typeof="sa:ContributorRole">
				<a property="schema:author" href="http://github.com/pdan93" typeof="schema:Person">
				  <span property="schema:givenName">Daniel</span>
				  <span property="schema:familyName">Popescu</span>
				</a>
				<a href="#scienceai" property="sa:roleAffiliation" resource="http://github.com/pdan93">a</a>
				<sup property="sa:roleContactPoint" typeof="schema:ContactPoint">
				  <a property="schema:email" href="mailto:danielpopescu93@gmail.com" title="corresponding author">✉</a>
				</sup>
			  </li>
			  <!-- The first author, Robin Berjon -->
			  <li property="schema:author" typeof="sa:ContributorRole">
				<a property="schema:author" href="http://github.com/citeaalexandru" typeof="schema:Person">
				  <span property="schema:givenName">Alexandru</span>
				  <span property="schema:familyName">Citea</span>
				</a>
				<a href="#scienceai" property="sa:roleAffiliation" resource="http://github.com/citeaalexandru">a</a>
				<sup property="sa:roleContactPoint" typeof="schema:ContactPoint">
				  <a property="schema:email" href="mailto:citeaalexandru@gmail.com " title="corresponding author">✉</a>
				</sup>
			  </li>
			</ol>
			<!-- The affiliation list -->
			<ol>
			  <li id="scienceai">
				<a href="http://info.uaic.ro" typeof="schema:Corporation">
				  <span property="schema:name">info.uaic.ro</span>
				</a>
			  </li>
			</ol>
		</section>
		<section typeof="sa:Abstract">
			<h2>Introduction</h2>
			<p>The Malware ontology project is meant to help in identifiyng similarities between malware files. Based on in-depth analysis from multiple sources, a complete characterization of the file is made and based on it different conclusions can be taken and meta informations can be constructed. With different levels of scopes available for comparation, a visual client to help malware analysists and a customized malware ontology, the MalwareOWL tries to be a helpful tool for specialists.</p>
		</section>
		<section typeof="sa:MaterialsAndMethods">
			<h2>Materials And Methods</h2>
			<p>A custom ontology is constructed for the project, using certain vocabulary elements from dbpedia, schema.org to define known concepts, the authors are defining a malware vocabulary that works in unison with the results from the file analysis. This will define the different categories of information as concepts so that when the connections between files are verrified entire areas of one can be matched.</p>
			<p>Using online api's and tools (VirusTotal, malwr.com, MalwareViz, Mastiff) as many properties as possible are processed about the file, each of them being connected in the malware ontology. VirusTotal offers 5 main categories of information: Analysis, File detail, Relationships, Additional Information and Behavioural information. These categories will be defined as resources/concepts inside the ontology and are also in turn composed of subcategories. (For example File detail: Packers identified, PE header basic information, PE sections, Overlays, PE imports, Nr of PE resources by type, PE resources). These subcategories together with new types of properties will sometime be new ones. Therefore the goal is to have them dinamically created inside the ontology and dinamically inserted inside the whole graph.</p>
		</section>
		<section>
			<h2>Challenges</h2>
			<section>
				<h3>Mapping the ontology dinamically</h3>
				<p>Because new properties on files may be found in any moment, and also for a more scalable project, the ontology needs to be easily editable instantly, with new triples being inserted in it when new vocabulary names or new file properties are found. Using SPARQL 1.1 will help in that aspect as it allows insertion of new data while the ontology is still active.the type of the property values is also an important aspect to be considered, and it should also be linked and defined for it. While both numerical and alphabetical values can be analized based on closeness to others, the way to do it is different and it may well end up being visible inside the application.</p>
			</section>
			<section>
				<h3>Separating the simmilarities</h3>
				<p>As long as they point to common concepts simmilarities can be found between any two files. We may end up with thousands of "simmilar" files. Therefore a limit must be set on the number of edges between two files and also, adding a second limit based on percentage (calculated on multiple properties common to the 2 files) increases the effectiveness of the application. This will be called the "sensibility" of the comparison and it will be a given parametter for all the API calls, and on the client it will convienently be displayed in the right down corner, as a slider with percentage values between 0-100%. The chosen value will mean the MIN percentage of simmilarities found between the 2 files.</p>
			</section>
			<section>
				<h3>Providing an API</h3>
				<p>The client for the application will use API endpoints to get the needed file properties, values and simmilarities. The API needs to transform requests into valid SPARQL interogations and then interpretate and convert the response. An OpenAPI specification is available <a href="https://pdan93.github.io/MalwareOWL/api_spec.html">here</a>. The main resource in the API is of course the hash of the file. This identifies it uniquely and helps in specifing the different scopes we want information for regarding it. For example calling API_URL/md5hash/Additional/FileIdentification/Filetype will return the value of the property "File type" for that md5. "Additional/FileIdentification/Filetype" also serves as the unique identificator for this property as well as a description of it's scope. </p>
			</section>
			
		</section>
		<section>
			<h2>Client Side application</h2>
			<p>On the client side, the application needs to be able to send requests on the file and present the results by constructing a visual graph. The different scopes are treated with the scrooling functionality. When a user goes witht he mouse on a section and scrools in, that section expands taking over the screeen and displaying more information about it. This can be seen in the representation of the leveled scopes below.</p>
			<figure>
				<img src="viewer_level_1.png" />
				<caption>Whole scope view of the hash</caption>
			</figure>
			<figure>
				<img src="viewer_level_2.png" />
				<caption>Category scope view of the hash</caption>
			</figure>
			<figure>
				<img src="viewer_level_3.png" />
				<caption>Subcategory scope view of the hash</caption>
			</figure>
			<figure>
				<img src="viewer_level_4.png" />
				<caption>Properties scope view of the hash</caption>
			</figure>
		</section>
		<section typeof="sa:Conclusion">
			<h2>Conclusion</h2>
			<p>Through an ontology the connections between infected files are explored in depth, this provides valuable help and insight for malware analysis speeding up the process and finding new connections between previously unknown malwares.</p>
		</section>
	</article>
    
</body>
</html>